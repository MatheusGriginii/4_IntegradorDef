<div class="card">
  <div class="card-header">
    <h4 class="mb-0">
      <i class="fas fa-user me-2"></i>
      {{ isEdicao ? 'Editar' : 'Novo' }} Usuário - Panificadora ADORELA
    </h4>
  </div>
  
  <div class="card-body">
    <form #usuarioForm="ngForm" (ngSubmit)="salvar()">
      <!-- Dados básicos -->
      <div class="row">
        <div class="col-md-6 mb-3">
          <label for="nome" class="form-label">Nome Completo *</label>
          <input 
            type="text" 
            id="nome"
            name="nome"
            class="form-control" 
            [(ngModel)]="usuario.nome"
            required
            #nome="ngModel"
            placeholder="Digite o nome completo do funcionário"
          >
          @if (nome.invalid && nome.touched) {
            <div class="text-danger mt-1">
              <small>Nome é obrigatório</small>
            </div>
          }
        </div>
        
        <div class="col-md-6 mb-3">
          <label for="email" class="form-label">Email *</label>
          <input 
            type="email" 
            id="email"
            name="email"
            class="form-control" 
            [(ngModel)]="usuario.email"
            required
            #email="ngModel"
            placeholder="Digite o email do funcionário"
          >
          @if (email.invalid && email.touched) {
            <div class="text-danger mt-1">
              <small>Email deve ter formato válido</small>
            </div>
          }
        </div>
      </div>

      <!-- Configurações administrativas -->
      <div class="card mt-4">
        <div class="card-header">
          <h5 class="mb-0">
            <i class="fas fa-cog me-2"></i>
            Configurações do Sistema
          </h5>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-6 mb-3">
              <label for="perfil" class="form-label">Perfil de Acesso *</label>
              <select 
                id="perfil"
                name="perfil"
                class="form-select" 
                [(ngModel)]="usuario.perfil"
                required
                #perfil="ngModel"
              >
                <option value="">Selecione o perfil</option>
                @for (opcao of perfilOptions; track opcao.value) {
                  <option [value]="opcao.value">{{ opcao.label }}</option>
                }
              </select>
              @if (perfil.invalid && perfil.touched) {
                <div class="text-danger mt-1">
                  <small>Perfil é obrigatório</small>
                </div>
              }
              <small class="form-text text-muted">
                <strong>Administrador:</strong> Acesso completo ao sistema<br>
                <strong>Funcionário:</strong> Acesso limitado às operações básicas
              </small>
            </div>
            
            <div class="col-md-6 mb-3">
              <label class="form-label">Status do Usuário</label>
              <div class="form-check form-switch mt-2">
                <input 
                  class="form-check-input" 
                  type="checkbox" 
                  id="ativo"
                  name="ativo"
                  [(ngModel)]="usuario.ativo"
                >
                <label class="form-check-label" for="ativo">
                  <span class="badge" [class]="usuario.ativo ? 'bg-success' : 'bg-secondary'">
                    {{ usuario.ativo ? 'Ativo' : 'Inativo' }}
                  </span>
                </label>
              </div>
              <small class="form-text text-muted">
                Usuários inativos não podem acessar o sistema
              </small>
            </div>
          </div>

          @if (!isEdicao) {
            <div class="row">
              <div class="col-12">
                <div class="alert alert-info">
                  <i class="fas fa-info-circle me-2"></i>
                  <strong>Senha Padrão:</strong> Uma senha temporária será gerada automaticamente. 
                  O usuário deverá alterá-la no primeiro acesso.
                </div>
              </div>
            </div>
          }
        </div>
      </div>

      <!-- Botões -->
      <div class="d-flex justify-content-between mt-4">
        <button 
          type="button" 
          class="btn btn-secondary"
          routerLink="/app/usuarios"
        >
          <i class="fas fa-arrow-left me-1"></i>
          Voltar
        </button>
        
        <div>
          @if (isEdicao) {
            <button 
              type="button" 
              class="btn btn-warning me-2"
              (click)="alterarStatus()"
            >
              <i class="fas fa-toggle-on me-1"></i>
              {{ usuario.ativo ? 'Desativar' : 'Ativar' }}
            </button>
            
            <button 
              type="button" 
              class="btn btn-danger me-2"
              (click)="confirmarExclusao()"
            >
              <i class="fas fa-trash me-1"></i>
              Excluir
            </button>
          }
          
          <button 
            type="submit" 
            class="btn btn-primary"
            [disabled]="usuarioForm.invalid || salvando"
          >
            @if (salvando) {
              <div class="spinner-border spinner-border-sm me-1" role="status">
                <span class="visually-hidden">Salvando...</span>
              </div>
            } @else {
              <i class="fas fa-save me-1"></i>
            }
            {{ isEdicao ? 'Atualizar' : 'Criar Usuário' }}
          </button>
        </div>
      </div>
    </form>
  </div>
</div>
